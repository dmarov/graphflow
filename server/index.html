<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <style>
        html, body {
            height: 100%;
            padding: 0;
            margin: 0;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        #canvas {
            flex-grow: 1;
        }

        .node  {
            width: 150px;
            max-width: 150px;
            height: 50px;
            max-height: 50px;
            background: #ffdbab;
            border: 1px solid #bababa;
            border-radius: 1000px;
            white-space: nowrap;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body>
    <div id="canvas"></div>

    <script type="module">
        import "./lib/index.js";

        const el = document.querySelector("#canvas");

        const canvas = new GraphFlow.Canvas(el, { 
            scale: { enabled: true },
            shift: { enabled: true },
            nodes: { draggable: true }
        });

        function createNodeElement(name) {
            const node =  document.createElement('div');
            const text =  document.createElement('div');

            node.classList.add("node");
            node.appendChild(text);

            text.innerText = name;

            const frontPort = document.createElement('div');
            node.prepend(frontPort);

            const backPort = document.createElement('div');
            node.appendChild(backPort);

            node.inPort = frontPort;
            node.outPort = backPort;

            return node;
        }

        const node1 = createNodeElement("Node 1");
        const node2 = createNodeElement("Node 2");
        const node3 = createNodeElement("Node 3");
        const node4 = createNodeElement("Node 4");

        canvas
            .addNode({ id: "node-1", element: node1, x: 200, y: 400 })
            .setPort({ id: "port-1-1", element: node1.inPort, nodeId: "node-1" })
            .setPort({ id: "port-1-2", element: node1.outPort, nodeId: "node-1" })
            .addNode({ id: "node-2", element: node2, x: 600, y: 500 })
            .setPort({ id: "port-2-1", element: node2.inPort, nodeId: "node-2" })
            .setPort({ id: "port-2-2", element: node2.outPort, nodeId: "node-2" })
            .addNode({ id: "node-3", element: node3, x: 200, y: 800 })
            .setPort({ id: "port-3-1", element: node3.inPort, nodeId: "node-3" })
            .setPort({ id: "port-3-2", element: node3.outPort, nodeId: "node-3" })
            .addNode({ id: "node-4", element: node4, x: 1000, y: 600 })
            .setPort({ id: "port-4-1", element: node4.inPort, nodeId: "node-4" })
            .setPort({ id: "port-4-2", element: node4.outPort, nodeId: "node-4" })
            .connectPorts({ id: "con-1", from: "port-1-2", to: "port-2-1" })
            .connectPorts({ id: "con-2", from: "port-3-2", to: "port-2-1" })
            .connectPorts({ id: "con-3", from: "port-2-2", to: "port-4-1" });
    </script>
</body>
</html>
